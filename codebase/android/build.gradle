buildscript {

    ext {
        // App version code
        appVersionCode = 88

        // App version name
        appVersionName = "2023.08.15.0"

        // Lint
        lintVersion = "30.2.1"

        // Compile SDK version
        compileSdkVersion = 34

        // Minimum SDK version
        minSdkVersion = 27

        // Target SDK version
        targetSdkVersion = 34

        // Jetpack compose compiler
        jetpackComposeCompilerVersion = "1.4.3"

        // Firebase BoM
        firebaseBomVersion = "29.1.0"
    }

    repositories {
        google()
        mavenCentral()
    }

    dependencies {

        // Build tools
        classpath libs.plugin.gradle.build.tools

        // Kotlin gradle plugin
        classpath libs.plugin.kotlin.gradle

        // Hilt
        classpath libs.plugin.hilt.android

        // Google services gradle plugin for Firebase
        classpath libs.plugin.google.services

        // Jacoco
        classpath libs.plugin.jacoco

        // Detekt
        classpath libs.plugin.detekt
    }
}

plugins {
    alias libs.plugins.kotlin.android apply false
    alias libs.plugins.kotlin.jvm apply false
    alias libs.plugins.serialization apply false
    alias libs.plugins.kover
    alias libs.plugins.about.libraries
}

apply plugin: "io.gitlab.arturbosch.detekt"

// TODO-Abhi: Jacoco
//subprojects {
//    configurations.all {
//        resolutionStrategy {
//            eachDependency { details ->
//                if ("org.jacoco" == details.requested.group) {
//                    details.useVersion "0.8.7"
//                }
//            }
//        }
//    }
//}

task clean(type: Delete) {
    delete rootProject.buildDir
}

koverMerged {
    enable()

    filters {
        classes {
            excludes.addAll(
                    // Fragment
                    "*Fragment",
                    "*Fragment\$*",

                    // Activity
                    "*Activity",
                    "*Activity\$*",

                    // ViewBinding
                    "*.databinding.*",

                    // Hilt
                    "dagger.hilt.**",
                    "*HiltModules*",
                    "hilt_aggregated_deps.*",
                    "*.di.*",

                    // Room
                    "*Dao_Impl*",
                    "*MyRoomDatabase_AutoMigration*",
                    "*MyRoomDatabase_Impl*",

                    // BuildConfig
                    "*BuildConfig*",
            )
        }

        annotations {
            excludes.addAll(
                    "*Composable",
                    "*Preview",
                    "*Generated",
            )
        }
    }
}
